<!DOCTYPE html>
<html>
<head>
<title>ESP32 Bluetooth Control</title>
</head>
<body>
<button id="connect">Bluetooth接続</button>
<button id="on">点灯</button>
<button id="off">消灯</button>
<script >let device, characteristic;

// Bluetooth接続を行う関数
document.getElementById('connect').addEventListener('click', async () => {
  try {
    // ユーザーにデバイスの選択を求める
    device = await navigator.bluetooth.requestDevice({
      acceptAllDevices: true,
      optionalServices: ['3fb5626e-27b5-4cb9-b6ff-924b70f13215'] // ここにESP32のサービスUUIDを入れる
    });

    // 選択されたデバイスに接続
    const server = await device.gatt.connect();
    const service = await server.getPrimaryService('3fb5626e-27b5-4cb9-b6ff-924b70f13215'); // ここにESP32のサービスUUIDを入れる
    characteristic = await service.getCharacteristic('5dfaf517-f077-428d-b909-de9e321d1667'); // ここにESP32のキャラクタリスティックUUIDを入れる

    console.log('Bluetoothデバイスに接続しました！');
  } catch (error) {
    console.log('Bluetooth接続に失敗しました: ' + error);
  }
});

// コマンドをESP32に送信する関数
function sendCommand(command) {
  if (device && characteristic) {
    characteristic.writeValue(new TextEncoder().encode(command));
  }
}

// 各方向ボタンにイベントリスナーを設定
['on', 'off'].forEach(direction => {
  document.getElementById(direction).addEventListener('click', () => {
    sendCommand(direction);
    console.log('コマンド送信: ' + direction);
  });
});</script>
</body>
</html>
